x <- read_rds("/Users/sunxin/Documents/Projects/chipseq/20211220/count_black.rds")
x
# GenomicRanges; extract seqnames, ranges, strand.
peaks <- granges(x)
peaks
# CHIPseeker:chip peak annotation, comparison and visualization.
peaks <- annotatePeak(peaks,TxDb = TxDb.Mmusculus.UCSC.mm10.knownGene, annoDb = "org.Mm.eg.db")
peaks
plotAnnoPie(peaks)
sessionInfo()
library(tidyverse)
library(SummarizedExperiment)
library(ChIPseeker)
library(TxDb.Mmusculus.UCSC.mm10.knownGene)
library(org.Mm.eg.db)
x <- read_rds("/Users/sunxin/Documents/Projects/chipseq/20211220/count_black.rds")
x
peaks <- granges(x)
peaks
peaks <- annotatePeak(peaks,TxDb = TxDb.Mmusculus.UCSC.mm10.knownGene, annoDb = "org.Mm.eg.db")
peaks
plotAnnoPie(peaks)
sessionInfo()
library(tidyverse)
library(csaw)
library(edgeR)
library(limma)
library(omisc)
library(ChIPseeker)
theme_set(cowplot::theme_cowplot())
filtered.data <- read_rds("/Users/sunxin/Documents/Projects/chipseq/20211220/Analysis_in_R/5.csaw/csaw_filtered_subset.rds")
y <- asDGEList(filtered.data)
y$genes <- as.data.frame(granges(filtered.data))
colnames(y) <- colnames(filtered.data)
y$samples$group <- factor(sub("-.*", "", colnames(y)), levels = c("WT", "KO"))
summary(y)
plotMDS(y, top = Inf, col = c("blue", "red")[y$samples$group])
ave_cpm <- edgeR::aveLogCPM(y, log = TRUE)
qplot(ave_cpm, bins = 30)
# select cpm
table(ave_cpm > 1.5)
y <- y[ave_cpm > 1.5, ]
plotMDS(y, top = Inf, col = c("blue", "red")[y$samples$group])
txdb <- TxDb.Mmusculus.UCSC.mm10.knownGene::TxDb.Mmusculus.UCSC.mm10.knownGene
res <- annotatePeak(GRanges(y$genes), TxDb = txdb, annoDb = "org.Mm.eg.db")
ggplot(res@annoStat |> mutate(Feature = fct_reorder(Feature, Frequency)), aes(Feature, Frequency)) +
geom_col() +
coord_flip()
d <- as.data.frame(res@anno)
y$genes <- left_join(y$genes, d)
design <- model.matrix(~0+group, y$samples)
colnames(design) <- levels(y$samples$group)
design
v <- voom(y, design, span = 0.5, save.plot = TRUE)
omisc::plot_voom(v) + geom_density_2d()
fit <- lmFit(v, design)
con <- makeContrasts(KOvsWT = KO - WT, levels = design)
con
fit2 <- contrasts.fit(fit, con)
fit2 <- eBayes(fit2)
topTable(fit2, n = 50)
res <- decideTests(fit2, p.value = 0.05)
vennDiagram(res)
z <- y[res[, 1] != 0, ]
z$genes <- z$genes |> mutate(annotation_simple = sub("Intron \\(.*", "Intron", annotation))
z$genes <- z$genes |> mutate(annotation_simple = sub("Exon \\(.*", "Intron", annotation_simple))
d <- z$genes
d <- d |> dplyr::count(annotation_simple)
d <- d |> mutate(annotation_simple = fct_reorder(annotation_simple, n))
ggplot(d, aes(annotation_simple, n)) +
geom_col() +
coord_flip()
z$genes |>
dplyr::count(SYMBOL, sort = TRUE)
a <- z$genes |> filter(SYMBOL == "Ifng")
a
pos <- which(z$genes$SYMBOL == "Ifng")
pos
pos.label <- z[pos,]$genes$SYMBOL
pos.label
library(ComplexHeatmap)
ann_mark <- rowAnnotation(foo=anno_mark(at=pos, labels=pos.label))
plot_heatmap(z, show_row_names=FALSE, right_annotation=ann_mark)
plot_heatmap(z, show_row_names = FALSE, row_split = z$genes$annotation_simple,right_annotation=ann_mark)
go <- goana(fit2, coef = "KOvsWT", geneid = "geneId", FDR = 0.01, species = "Mm")
topGO(go, "Up", ontology = "BP")
topGO(go, "Down", ontology = "BP")
omisc::plot_enrichment(go, ontology = "BP")
sessionInfo()
omisc::plot_enrichment(go, ontology = "BP")
ggsave("/Users/sunxin/Documents/Projects/submission/Figs/Fig.6_atacchip/Fig6C.pdf",width = 12, height = 6)
library(tidyverse)
library(patchwork)
theme_set(cowplot::theme_cowplot())
library(edgeR)
library(limma)
library(omisc)
library(ComplexHeatmap)
library(readxl)
x <- read_rds("/Users/sunxin/Documents/Projects/atacseq/new_update_20220912/dge.rds")
x
x <- x[, x$samples$condition == "Ctl"]
x
keep <- rowSums(cpm(x) > 1) >= 2
table(keep)
x <- x[keep, , keep.lib.sizes = TRUE]
x <- calcNormFactors(x, method = "TMM")
design <- model.matrix(~ 0 + background, x$samples)
rownames(design) <- colnames(x)
colnames(design) <- sub("background", "", colnames(design))
design
v <- voom(x, design, plot = FALSE, save.plot = TRUE)
plot_voom(v)
fit <- lmFit(v, design)
con <- makeContrasts(
KOvsWT=KO - WT,
levels = design
)
con
fit2 <- contrasts.fit(fit, con)
fit2 <- eBayes(fit2)
plot_hist(fit2)
topTable(fit2)
top <- topTable(fit2, coef = "KOvsWT", number = Inf)
head(top)
ids <- rownames(topTable(fit2, coef="KOvsWT", p.value=0.05, sort.by="logFC", n=200))
omisc::plot_heatmap(x[ids, ], scale=TRUE)
top_100 <- head(top, 100)
omisc::plot_heatmap(x[rownames(top_100), ], show_row_names=FALSE)
top_dar <- topTable(fit2, coef="KOvsWT", n=Inf)
head(top_dar)
top_dar <- top_dar |>
mutate(DAR=factor(ifelse(adj.P.Val < 0.01, "KOvsWT", "Not DAR"))) |>
mutate(DAR=relevel(DAR, "Not DAR")) |>
drop_na()
ggplot(top_dar, aes(DAR, fill=Region)) +
geom_bar(position="fill")
tf <- read_excel("/Users/sunxin/Documents/Projects/mice_TFs_list.xlsx")
tf<- data.frame(tf)
tf <- tf$genename
head(tf)
top_p <- top[top$adj.P.Val <= 0.01,]
foo <- top_p$SYMBOL
head(foo)
genes <- c( "Arnt2" ,  "Bmi1" ,   "Zfp36l1", "Klf5" ,   "Camk4",   "Cdkn2d" , "Cebpd"  , "Cops2" ,  "Egr2" ,   "Eomes" ,  "Fosl2" ,  "Gas7"  ,  "Hdac5", "Hmga1" ,  "Ifnar2" , "Irf2" ,   "Irf4"  ,  "Klf2" ,   "Lef1"  ,  "Mbd2" ,   "Mef2c" ,  "Foxk1"  , "Cited2" , "Nab2" ,  "Nfatc1" , "Nfatc2" , "Nfe2l1" , "Nfkb1" ,  "Pou2f2"  ,"Tcf7l2" , "Tle4"   , "Ncoa4"  , "Snai3" ,  "Rab11a"  ,"Prdm5"  , "Uhrf2" ,  "Ell2" ,   "Trerf1" , "Rab8b"  ,"Dmrta1",  "E2f2" ,   "Irf2bp1" )
id <-which(top_p$SYMBOL %in% genes)
tfid<- top_p[id,]
foo <-x[rownames(tfid), ]
omisc::plot_heatmap(x[rownames(tfid), ], scale=TRUE)
name <- paste0(foo$genes$SYMBOL,"_", rownames(foo))
foo$genes$SYMBOL <- name
omisc::plot_heatmap(foo, scale=TRUE)
sessionInfo()
library(tidyverse)
library(edgeR)
library(limma)
library(omisc)
library(d10misc)
library(ComplexHeatmap)
library(scmisc)
library(patchwork)
source("/Users/sunxin/Documents/Projects/atacseq/func.R")
theme_set(cowplot::theme_cowplot())
x <- read_rds("/Users/sunxin/Documents/Projects/atacseq/new_update_20220912/dge.rds")
x
keep <- rowSums(cpm(x) > 10) >= 2
table(keep)
x <- x[keep, , keep.lib.sizes = TRUE]
x <- calcNormFactors(x, method = "TMM")
x
design <- model.matrix(~ 0 + group, x$samples)
rownames(design) <- colnames(x)
colnames(design) <- sub("group", "", colnames(design))
design
v <- voom(x, design, plot = FALSE, save.plot = TRUE)
plot_voom(v)
fit <- lmFit(v, design)
con <- makeContrasts(
background = (KO.Ctl + KO.Sti) / 2  - (WT.Ctl + WT.Sti) / 2,
condition = (WT.Sti + KO.Sti) / 2  - (WT.Ctl + KO.Ctl) / 2,
KO = KO.Sti - KO.Ctl,
WT = WT.Sti - WT.Ctl,
Sti = KO.Sti - WT.Sti,
Ctl = KO.Ctl - WT.Ctl,
levels = design
)
con
fit2 <- contrasts.fit(fit, con)
fit2 <- eBayes(fit2)
to_tidy(fit2$p.value, "gene", "group", "p.value") %>%
filter(group != "(Intercept)") %>%
ggplot(aes(p.value)) +
geom_histogram(binwidth = .01) +
facet_wrap(~group)
topTable(fit2)
top <- topTable(fit2, coef = "Ctl", number = Inf)
head(top)
go <- goana(fit2, coef = "Ctl", geneid = "geneId", FDR = 0.01, species = "Mm")
topGO(go, "Up", ontology = "MF")
topGO(go, "Down", ontology = "MF")
omisc::plot_enrichment(go, ontology = "MF")
go2 <- goana(fit2, coef = "Sti", geneid = "geneId", FDR = 0.01, species = "Mm")
omisc::plot_enrichment(go2, ontology = "MF")
sessionInfo()
library(readxl)
library(here)
library(tidyverse)
library(edgeR)
library(limma)
library(omisc)
library(d10misc)
library(ComplexHeatmap)
library(patchwork)
theme_set(cowplot::theme_cowplot())
x <- read_rds("/Users/sunxin/Documents/Projects/atacseq/RNAseq/output/rnaseq/dge.rds")
x
x <- x[, x$samples$condition == "Ctl"]
x
keep <- rowSums(cpm(x) > 1) >= 2
table(keep)
x <- x[keep, , keep.lib.sizes = TRUE]
x <- calcNormFactors(x, method = "TMM")
genes <- c( "Arnt2" ,  "Bmi1" ,   "Zfp36l1", "Klf5" ,   "Camk4",   "Cdkn2d" , "Cebpd"  , "Cops2" ,  "Egr2" ,   "Eomes" ,  "Fosl2" ,  "Gas7"  ,  "Hdac5", "Hmga1" ,  "Ifnar2" , "Irf2" ,   "Irf4"  ,  "Klf2" ,   "Lef1"  ,  "Mbd2" ,   "Mef2c" ,  "Foxk1"  , "Cited2" , "Nab2" ,  "Nfatc1" , "Nfatc2" , "Nfe2l1" , "Nfkb1" ,  "Pou2f2"  ,"Tcf7l2" , "Tle4"   , "Ncoa4"  , "Snai3" ,  "Rab11a"  ,"Prdm5"  , "Uhrf2" ,  "Ell2" ,   "Trerf1" , "Rab8b"  ,"Dmrta1",  "E2f2" ,   "Irf2bp1" )
id <-which(x$genes$symbol %in% genes)
foo<- x[id,]
omisc::plot_heatmap(foo,scale=TRUE, symbol.col="symbol")
sessionInfo()
library(tidyverse)
library(edgeR)
library(limma)
library(omisc)
library(d10misc)
library(ComplexHeatmap)
x <- read_rds("/Users/sunxin/Documents/Projects/atacseq/RNAseq/output/rnaseq/dge.rds")
x
keep <- rowSums(cpm(x) > 10) >= 2
table(keep)
x <- x[keep, , keep.lib.sizes = TRUE]
x <- calcNormFactors(x, method = "TMM")
design <- model.matrix(~ 0 + group, x$samples)
rownames(design) <- colnames(x)
colnames(design) <- sub("group", "", colnames(design))
design
v <- voom(x, design, plot = FALSE, save.plot = TRUE)
plot_voom(v)
fit <- lmFit(v, design)
con <- makeContrasts(
background = (KO.Ctl + KO.Sti) / 2  - (WT.Ctl + WT.Sti) / 2,
condition = (WT.Sti + KO.Sti) / 2  - (WT.Ctl + KO.Ctl) / 2,
KO = KO.Sti - KO.Ctl,
WT = WT.Sti - WT.Ctl,
Sti = KO.Sti - WT.Sti,
Ctl = KO.Ctl - WT.Ctl,
levels = design
)
con
fit2 <- contrasts.fit(fit, con)
fit2 <- eBayes(fit2)
to_tidy(fit2$p.value, "gene", "group", "p.value") %>%
filter(group != "(Intercept)") %>%
ggplot(aes(p.value)) +
geom_histogram(binwidth = .01) +
facet_wrap(~group)
topTable(fit2)
top <- topTable(fit2, coef = "condition", number = Inf)
head(top)
res <- decideTests(fit2, p.value = 0.01)
head(res)
go <- goana(fit2, coef = "Ctl", FDR = 0.01, species = "Mm")
topGO(go, "Up", ontology = "BP")
topGO(go, "Down", ontology = "BP")
plot_enrichment(go, ontology = "MF")
sessionInfo()
library(tidyverse)
library(Seurat)
library(scmisc)
library(cowplot)
library(patchwork)
library(ggplot2)
library(reticulate)
set.seed(1)
m <- Read10X_h5("/Users/sunxin/Documents/Projects/OCT2_sc/WT_filtered_feature_bc_matrix.h5")
colnames(m) <- paste0("WT:", colnames(m))
x <- CreateSeuratObject(counts = m, project = "OCT2")
head(colnames(x))
x$background <- "WT"
# DefaultAssay(x) <- 'RNA'
x <- NormalizeData(x)
x <- FindVariableFeatures(x, nfeatures = 5000)
VariableFeaturePlot(x)
x <- ScaleData(x)
x <-  RunPCA(x)
ElbowPlot(x, ndims = 50)
DimPlot(x)
x<- RunUMAP(x, dims = 1:20)
x <- FindNeighbors(x, dims = 1:20)
x <- FindClusters(x, algorithm = 4, resolution = 0.6)
DimPlot(x, label = TRUE) + NoLegend()
plot_coord(x, size= 0.1, expand = "seurat_clusters", ncol=4)
x <- PercentageFeatureSet(x, "mt-", col.name = "mito.percentage")
VlnPlot(x, c("nCount_RNA", "nFeature_RNA","mito.percentage"),ncol = 1, pt.size=0.1)
mtgene <- grep("mt-",rownames(x), value = TRUE)
DoHeatmap(x, mtgene, slot = "data") +
scale_fill_gradient(low = "white", high = "red") +
guides(color = FALSE)
genes <- grep("^Rpl[0-9][0-9]$", rownames(x), value = TRUE)
DoHeatmap(x, genes, slot = "data") +
scale_fill_gradient(low = "white", high = "red") +
guides(color = FALSE)
genes <- grep("^Rps[0-9][0-9]$", rownames(x), value = TRUE)
DoHeatmap(x, genes, slot = "data") +
scale_fill_gradient(low = "white", high = "red") +
guides(color = FALSE)
cc <- sapply(cc.genes.updated.2019, str_to_sentence)
x <- CellCycleScoring(x, cc$s.genes, cc$g2m.genes)
FeaturePlot(x, c("S.Score", "G2M.Score"), order = TRUE, blend = TRUE, label=TRUE)
sessionInfo()
library(here)
library(tidyverse)
library(Seurat)
library(scmisc)
library(cowplot)
library(patchwork)
library(ggplot2)
set.seed(1)
m <- Read10X_h5("/Users/sunxin/Documents/Projects/OCT2_sc/KO_filtered_feature_bc_matrix.h5")
colnames(m) <- paste0("KO:", colnames(m))
x <- CreateSeuratObject(counts = m, project = "OCT2")
x$background <- "KO"
x <- NormalizeData(x)
x <- FindVariableFeatures(x, nfeatures = 5000)
VariableFeaturePlot(x)
x <- ScaleData(x)
x <-  RunPCA(x)
ElbowPlot(x, ndims = 50)
DimPlot(x)
x<- RunUMAP(x, dims = 1:20)
x <- FindNeighbors(x, dims = 1:20)
x <- FindClusters(x, algorithm = 4, resolution = 0.6)
DimPlot(x, label = TRUE) + NoLegend()
x <- PercentageFeatureSet(x, "mt-", col.name = "mito.percentage")
VlnPlot(x, c("nCount_RNA", "nFeature_RNA","mito.percentage"),ncol = 1, pt.size=0.1)
mtgene <- grep("mt-",rownames(x), value = TRUE)
DoHeatmap(x, mtgene, slot = "data") +
scale_fill_gradient(low = "white", high = "red") +
guides(color = FALSE)
genes <- grep("^Rpl[0-9][0-9]$", rownames(x), value = TRUE)
DoHeatmap(x, genes, slot = "data") +
scale_fill_gradient(low = "white", high = "red") +
guides(color = FALSE)
genes <- grep("^Rps[0-9][0-9]$", rownames(x), value = TRUE)
DoHeatmap(x, genes, slot = "data") +
scale_fill_gradient(low = "white", high = "red") +
guides(color = FALSE)
cc <- sapply(cc.genes.updated.2019, str_to_sentence)
x <- CellCycleScoring(x, cc$s.genes, cc$g2m.genes)
FeaturePlot(x, c("S.Score", "G2M.Score"), order = TRUE, blend = TRUE, label=TRUE)
sessionInfo()
library(tidyverse)
library(Seurat)
library(Canek)
library(scmisc)
set.seed(1)
theme_set(cowplot::theme_cowplot())
x <- read_rds("/Users/sunxin/Documents/Projects/NKsc_tumor/analysis_in_R/4.spleen_TIL_integration/output/WT_KO_spleen_integration_process_livespleen_nk_sampling.rds")
DefaultAssay(x) <- "RNA"
DimPlot(x, split.by="background", label = TRUE) + NoAxes()+
ggtitle("Canek integration of splenic WT and KO NK cells")+
theme(plot.title = element_text(size=13, face = "bold.italic"))
marker <- c("Pou2f2","Gzmk","Gzmb","Ifng","Cxcr6","Prf1")
VlnPlot(x, features = marker, pt.size = 0.05, split.by = "background")
FeaturePlot(x, marker, order=TRUE, label = TRUE, label.size = 3.5, pt.size = 0.2, ncol = 3) &NoLegend() + NoAxes()
ggplot(x[[]], aes(background, fill=seurat_clusters))+
geom_bar()
deg <- FindAllMarkers(x,max.cells.per.ident = 500, verbose = FALSE)
top <- deg%>%filter(p_val_adj<0.01, abs(avg_log2FC)>1)
top
top_genes <- top_deg(deg)
top_genes
y <-sample_cells(x, group = "seurat_clusters")
plot_heatmap(y[top_genes$gene,], column_split= y$seurat_clusters)
DefaultAssay(x) <- "ADT"
x <- NormalizeData(x, normalization.method="CLR")
m <- GetAssayData(x, assay="ADT", slot="data")
d <- data.frame(CD27 = m["CD27", ] > .5, CD11B = m["CD11B", ] > .5)
d$total <- apply(d, 1, sum)
d <- get_coord(x, add.exprs=c("CD27", "CD11B"), assay="ADT")
d_WT <- d |> filter(background == "WT_spleen")
d_KO <- d |> filter(background == "KO_spleen")
ggplot(d_WT, aes(CD11B, CD27)) +
geom_point(size=.5) +
geom_density_2d(color="red") +
geom_vline(xintercept=0.28, color="limegreen", lwd=1) +
geom_hline(yintercept=0.5, color="limegreen", lwd=1) +
labs(title="WT_spleen") +
ggplot(d_KO, aes(CD11B, CD27)) +
geom_point(size=.5) +
geom_density_2d(color="red") +
geom_vline(xintercept=0.6, color="limegreen", lwd=1) +
geom_hline(yintercept=0.8, color="limegreen", lwd=1) + # .75
labs(title="KO_spleen")
d_WT <- d_WT |> mutate(stage=case_when(
CD27 >= 0.5 & CD11B < 0.28 ~ "R1",
CD27 >= 0.5 & CD11B >= 0.28 ~ "R2",
CD27 < 0.5 & CD11B >= 0.28 ~ "R3",
TRUE ~ "R0"
))
d_WT |> dplyr::count(stage)
d_KO <- d_KO |> mutate(stage=case_when(
CD27 >= 0.8 & CD11B < 0.6 ~ "R1",
CD27 >= 0.8 & CD11B >= 0.6 ~ "R2",
CD27 < 0.8 & CD11B >= 0.6 ~ "R3",
TRUE ~ "R0"
))
d_KO |> dplyr::count(stage)
ggplot(d_WT, aes(CD11B, CD27, color=stage)) +
geom_point(size=.5) +
geom_density_2d(color="black") +
geom_vline(xintercept=0.28, color="limegreen", lwd=1) +
geom_hline(yintercept=0.5, color="limegreen", lwd=1) +
labs(title="WT") +
ggplot(d_KO, aes(CD11B, CD27, color=stage)) +
geom_point(size=.5) +
geom_density_2d(color="black") +
geom_vline(xintercept=0.6, color="limegreen", lwd=1) +
geom_hline(yintercept=0.8, color="limegreen", lwd=1) +
labs(title="KO")
d <- rbind(d_WT, d_KO)
ggplot(d, aes(background, fill=stage)) +
geom_bar(position="fill")
d <- d[colnames(x), ]
x <- AddMetaData(x, d$stage, col.name="stage")
DimPlot(x, group.by="stage", split.by = "background")  + NoAxes()
DimPlot(x, group.by="stage")  + NoAxes()
DimPlot(x, group.by="stage", split.by = "seurat_clusters")  + NoAxes()
DimPlot(x, split.by = "stage")  + NoAxes()
DimPlot(x, split.by = "stage", label=TRUE)  + NoAxes()
DimPlot(x, group.by = "stage", label=TRUE)  + NoAxes()
DimPlot(x, split.by = "stage", label=TRUE)  + NoAxes()
DimPlot(x, split.by = "stage",group.by = "background", label=TRUE)  + NoAxes()
library(tidyverse)
library(Seurat)
library(Canek)
library(scmisc)
set.seed(1)
theme_set(cowplot::theme_cowplot())
plot_coord(x,size=0.1,expand = "background")
plot_coord(x,size=0.1,expand = "stage")
ggplot(x[[]], aes(seurat_clusters, fill = background)) +
geom_bar(position = "fill")
plot_coord(x,size=0.1,expand = "stage")
ggplot(x[[]], aes(seurat_clusters, fill = background)) +
geom_bar(position = "fill")
plot_coord(x,size=0.1,expand = "stage", label = TRUE)
x$stage
ggplot(d, aes(seurat_clusters, fill=stage)) +
geom_bar(position="fill")
160/300*55
library(tidyverse)
library(Seurat)
library(Canek)
library(scmisc)
set.seed(1)
x <- read_rds("/Users/sunxin/Documents/Projects/NKsc_tumor/analysis_in_R/4.spleen_TIL_integration/output/NEW_NK_TIL_spleen_integration_process_livenk_sampling.rds")
DefaultAssay(x) <- "RNA"
DimPlot(x, split.by="background", label = TRUE) + NoLegend()+
theme(plot.title = element_text(size=13, face = "bold.italic"))
VlnPlot(x, "Zc3h12a", pt.size=.01, group.by = "background")+
stat_summary(fun.y = mean, geom='crossbar', width=0.4, colour ="red")+
ggtitle("Zc3h12a mean")
VlnPlot(x, "Cxcr6", pt.size=.01, group.by = "background")+
stat_summary(fun.y = mean, geom='crossbar', width=0.4, colour ="red")+
ggtitle("Cxcr6 mean")
sessionInfo()
library(tidyverse)
library(Seurat)
set.seed(1)
x <- read_rds("/Users/sunxin/Documents/Projects/NKsc_tumor/analysis_in_R/4.spleen_TIL_integration/output/NEW_NK_TIL_spleen_integration_process_livenk_sampling.rds")
DefaultAssay(x) <- "RNA"
DimPlot(x, split.by="background", label = TRUE) + NoLegend()+
theme(plot.title = element_text(size=13, face = "bold.italic"))
VlnPlot(x, "Zc3h12a", pt.size=.01, group.by = "background")+
stat_summary(fun.y = mean, geom='crossbar', width=0.4, colour ="red")+
ggtitle("Zc3h12a mean")
VlnPlot(x, "Cxcr6", pt.size=.01, group.by = "background")+
stat_summary(fun.y = mean, geom='crossbar', width=0.4, colour ="red")+
ggtitle("Cxcr6 mean")
sessionInfo()
library(tidyverse)
library(Seurat)
set.seed(1)
x <- read_rds("/Users/sunxin/Documents/Projects/NKsc_tumor/analysis_in_R/4.spleen_TIL_integration/output/NEW_NK_TIL_spleen_integration_process_livenk_sampling.rds")
DefaultAssay(x) <- "RNA"
VlnPlot(x, "Zc3h12a", pt.size=.01, group.by = "background")+
stat_summary(fun.y = mean, geom='crossbar', width=0.4, colour ="red")+
ggtitle("Zc3h12a mean")
VlnPlot(x, "Cxcr6", pt.size=.01, group.by = "background")+
stat_summary(fun.y = mean, geom='crossbar', width=0.4, colour ="red")+
ggtitle("Cxcr6 mean")
sessionInfo()
x <- read_rds("/Users/sunxin/Documents/Projects/NKsc_tumor/analysis_in_R/4.spleen_TIL_integration/output/NEW_NK_TIL_spleen_integration_process_livenk_sampling.rds")
x
VlnPlot(x, "Cxcr6", pt.size=.01, group.by = "background")+
stat_summary(fun.y = mean, geom='crossbar', width=0.4, colour ="red")+
ggtitle("Cxcr6")
VlnPlot(x, "Zc3h12a", pt.size=.01, group.by = "background")+
stat_summary(fun.y = mean, geom='crossbar', width=0.4, colour ="red")+
ggtitle("Zc3h12a")
VlnPlot(x, "Zc3h12a", pt.size=.01, group.by = "background")+
stat_summary(fun.y = mean, geom='crossbar', width=0.4, colour ="red")
VlnPlot(x, "Cxcr6", pt.size=.01, group.by = "background")+
stat_summary(fun.y = mean, geom='crossbar', width=0.4, colour ="red")
